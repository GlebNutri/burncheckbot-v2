import os
from dotenv import load_dotenv

load_dotenv()

# Настройки бота
BOT_TOKEN = os.getenv('BOT_TOKEN', 'YOUR_BOT_TOKEN_HERE')

# Настройки канала для подписки
CHANNEL_USERNAME = os.getenv('CHANNEL_USERNAME', '@wtfcrisis30')  # Без @
CHANNEL_LINK = os.getenv('CHANNEL_LINK', 'https://t.me/wtfcrisis30')
CHANNEL_NAME = os.getenv('CHANNEL_NAME', 'Кризис Тридцатилетних')

# Отключение проверки подписки (для тестирования)
DISABLE_SUBSCRIPTION_CHECK = os.getenv('DISABLE_SUBSCRIPTION_CHECK', 'false').lower() == 'true'

# Данные теста по методике В.В. Бойко
TEST_QUESTIONS = [
    # Фаза "Напряжение"
    {
        "phase": "Напряжение",
        "questions": [
            "Рабочие тупняки, косяки в организации и бардак — это уже не смешно. Они реально выматывают. Так?",
            "Ты чувствуешь, что ты на своём месте? ",
            "Бывает мысль: \"Кажется, я вообще не тем занимаюсь\"?",
            "Замечаешь, что стал(а) делать меньше, медленнее, не с тем запалом, как раньше?",
            "Твоё общение с людьми зависит от твоего настроения?",
            "У тебя есть ощущение, что от твоей работы ничего толком не зависит — ни для тебя, ни для других?",
            "Когда возвращаешься домой после работы — тебе нужно провести время в одиночестве?",
            "Если кто-то напрягает, просит что-то — стараешься свернуть разговор побыстрее?",
            "Чувствуешь, что у тебя внутри не осталось ни капли ресурса, чтобы поддерживать кого-то ещё?",
            "Твоя работа делает тебя безэмоциональным?"
        ]
    },
    # Фаза "Резистенция"
    {
        "phase": "Резистенция", 
        "questions": [
            "Люди на работе мне уже не особо интересны — просто делаю своё дело.",
            "Обычно я прихожу на работу вялым — После выходных не чувствую себя отдохнувшим.",
            "Часто ловлю себя на том, что общаюсь с людьми на автомате, без включения.",
            "Иногда хочется, чтобы особенно токсичные коллеги или клиенты просто исчезли.",
            "После общения с людьми я чувствую себя выжитым.",
            "На работе приходится надевать маску и изображать нормальное настроение.",
            "У нас на работе всё сложно — атмосфера скорее напряжённая, чем доброжелательная.",
            "За последние месяцы не ощущал(а), что реально помог кому-то через свою работу.",
            "Работаю как по инструкции: делаю всё как надо, но будто на автопилоте — без души.",
            "После работы хочется просто уединиться и побыть в полной тишине."
        ]
    },
    # Фаза "Истощение"
    {
        "phase": "Истощение",
        "questions": [
            "При мысли о работе у меня реально сжимается внутри: сердце колет, голова болит, тело напрягается.",
            "С начальником у меня нормальные, адекватные отношения.",
            "В последнее время на работе будто всё идёт через одно место — неудача за неудачей.",
            "Некоторые моменты в моей работе настолько выбешивают, что хочется просто всё бросить.",
            "Бывают дни, когда из-за усталости я тупо не вывожу — делаю меньше, хуже, и даже ругаюсь с людьми.",
            "Я так сильно вникаю в чужие проблемы, что свои уже не тяну.",
            "После работы я сразу еду домой и не хочу ни с кем общаться.",
            "В моей работе есть моменты, которые стабильно выбивают из равновесия.",
            "Общение с людьми на работе выматывает настолько, что под конец уже не хочется даже говорить.",
            "К концу дня я не готов ни с кем коммуницировать."
        ]
    }
]

# Ключи для подсчета баллов (1 - согласен, 0 - не согласен)
SCORING_KEYS = {
    "Напряжение": [1, 0, 1, 1, 1, 1, 1, 1, 1, 1],
    "Резистенция": [1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 
    "Истощение": [1, 0, 1, 1, 1, 1, 1, 1, 1, 1]
}

# Интерпретация результатов
INTERPRETATION = {
    "Напряжение": {
        "low": "Низкий уровень - фаза не сформирована",
        "medium": "Средний уровень - фаза в стадии формирования", 
        "high": "Высокий уровень - фаза сформирована"
    },
    "Резистенция": {
        "low": "Низкий уровень - фаза не сформирована",
        "medium": "Средний уровень - фаза в стадии формирования",
        "high": "Высокий уровень - фаза сформирована" 
    },
    "Истощение": {
        "low": "Низкий уровень - фаза не сформирована",
        "medium": "Средний уровень - фаза в стадии формирования",
        "high": "Высокий уровень - фаза сформирована"
    }
}

# Пороговые значения в процентах от максимально возможного балла
THRESHOLD_PERCENTAGES = {
    "low": 30,    # До 30% - низкий уровень
    "medium": 60, # 30-60% - средний уровень  
    "high": 100   # 60-100% - высокий уровень
}

def calculate_thresholds(phase_name):
    """
    Вычисляет пороговые значения для фазы на основе процентных соотношений
    """
    # Подсчитываем максимально возможный балл для фазы
    max_score = sum(SCORING_KEYS[phase_name])
    
    # Вычисляем пороги в абсолютных значениях
    thresholds = {
        "low": int(max_score * THRESHOLD_PERCENTAGES["low"] / 100),
        "medium": int(max_score * THRESHOLD_PERCENTAGES["medium"] / 100),
        "high": max_score
    }
    
    return thresholds

# Функция для получения порогов для конкретной фазы
def get_thresholds(phase_name):
    """
    Возвращает пороговые значения для указанной фазы
    """
    return calculate_thresholds(phase_name)

# Для обратной совместимости оставляем старую структуру THRESHOLDS
THRESHOLDS = {
    "Напряжение": get_thresholds("Напряжение"),
    "Резистенция": get_thresholds("Резистенция"), 
    "Истощение": get_thresholds("Истощение")
} 